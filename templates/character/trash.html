{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Select Trash</title>
    <link rel="stylesheet" href="{% static '/css/trash/trash.css' %}">
    <link rel="stylesheet" href="{% static '/css/chatbot/icon.css' %}">
    <meta name="csrf-token" content="{{ csrf_token }}">
    <link rel="stylesheet" href="{% static '/css/chatbot/nav.css' %}">

</head>

<body>

    <header class="chat-header" id="header">
        <div class="header-left">
          <a href="피드백 페이지 링크" class="header-feedback">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M21.9024 10.5976C21.4442 10.5333 20.976 10.5 20.5 10.5C17.2404 10.5 14.3455 12.0604 12.5212 14.471C12.3501 14.4887 12.1763 14.4978 12 14.4978C10.7188 14.4978 9.55217 14.0172 8.66691 13.2248L7.33309 14.7151C8.41871 15.6868 9.81141 16.3253 11.3466 16.4676C10.8023 17.7016 10.5 19.0662 10.5 20.5C10.5 20.976 10.5333 21.4442 10.5976 21.9024C5.7387 21.2205 2 17.0469 2 12C2 6.47715 6.47715 2 12 2C17.0469 2 21.2205 5.7387 21.9024 10.5976ZM21.8707 12.617C21.4254 12.5401 20.9674 12.5 20.5 12.5C17.7656 12.5 15.3512 13.8709 13.9068 15.9675C13.0194 17.2556 12.5 18.8156 12.5 20.5C12.5 20.9674 12.5401 21.4254 12.617 21.8707L21.8707 12.617ZM8.5 11.5C9.32843 11.5 10 10.8284 10 10C10 9.17157 9.32843 8.5 8.5 8.5C7.67157 8.5 7 9.17157 7 10C7 10.8284 7.67157 11.5 8.5 11.5ZM15.5 11.5C16.3284 11.5 17 10.8284 17 10C17 9.17157 16.3284 8.5 15.5 8.5C14.6716 8.5 14 9.17157 14 10C14 10.8284 14.6716 11.5 15.5 11.5Z"></path></svg>
          </a>
        </div>
        <span><p>Feel Buddy</p></span>
        <div class="header-right">
          <a href="로그아웃" class="header-logout">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C15.2713 2 18.1757 3.57078 20.0002 5.99923L17.2909 5.99931C15.8807 4.75499 14.0285 4 12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C14.029 20 15.8816 19.2446 17.2919 17.9998L20.0009 17.9998C18.1765 20.4288 15.2717 22 12 22ZM19 16V13H11V11H19V8L24 12L19 16Z"></path></svg>
            <!-- <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M5 22C4.44772 22 4 21.5523 4 21V3C4 2.44772 4.44772 2 5 2H19C19.5523 2 20 2.44772 20 3V6H18V4H6V20H18V18H20V21C20 21.5523 19.5523 22 19 22H5ZM18 16V13H11V11H18V8L23 12L18 16Z"></path></svg> -->
          </a>
        </div>
      
     </header>

    <nav class="mobile-footer" role="menulist">
        <a href="{% url 'users:main' %}" role="menuitem" aria-describedby="nav-current">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M20 20C20 20.5523 19.5523 21 19 21H5C4.44772 21 4 20.5523 4 20V11L1 11L11.3273 1.6115C11.7087 1.26475 12.2913 1.26475 12.6727 1.6115L23 11L20 11V20ZM11 13V19H13V13H11Z"></path>
            </svg>
            Home
        </a>
        <a href="{% url 'chatbot:emotion' %}" role="menuitem">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M2 13H8V21H2V13ZM9 3H15V21H9V3ZM16 8H22V21H16V8Z"></path></svg>
            
            Log
        </a>
        <a href="{% url 'character:trash' %}" role="menuitem" class="active">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path
                    d="M17 6H22V8H20V21C20 21.5523 19.5523 22 19 22H5C4.44772 22 4 21.5523 4 21V8H2V6H7V3C7 2.44772 7.44772 2 8 2H16C16.5523 2 17 2.44772 17 3V6ZM9 11V17H11V11H9ZM13 11V17H15V11H13ZM9 4V6H15V4H9Z">
                </path>
            </svg>
            Trash
        </a>
        <a href="{% url 'character:character_list' %}" role="menuitem">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M8 4H21V6H8V4ZM3 3.5H6V6.5H3V3.5ZM3 10.5H6V13.5H3V10.5ZM3 17.5H6V20.5H3V17.5ZM8 11H21V13H8V11ZM8 18H21V20H8V18Z"></path>
        </svg>
        List
       </a>
        <a href="{% url 'users:profile' %}" role="menuitem">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path
                    d="M20 22H4V20C4 17.2386 6.23858 15 9 15H15C17.7614 15 20 17.2386 20 20V22ZM12 13C8.68629 13 6 10.3137 6 7C6 3.68629 8.68629 1 12 1C15.3137 1 18 3.68629 18 7C18 10.3137 15.3137 13 12 13Z">
                </path>
            </svg>
            Profile
        </a>
        
        <i class="line" id="nav-current">current item</i>
    </nav>
<!--아이콘 추가된 부분 -->
<!-- <h1>Feelbuddy</h1> -->
<div id="pole">
    <div id="right">
        <div class="logo"><b>FE<span>EL</span>&nbsp;BU<span>D</span>DY</b></div>
    </div>
</div>
<div class="icon">
    <a href="{% url 'users:main' %}">
        <div class="icon__home">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M20 20C20 20.5523 19.5523 21 19 21H5C4.44772 21 4 20.5523 4 20V11L1 11L11.3273 1.6115C11.7087 1.26475 12.2913 1.26475 12.6727 1.6115L23 11L20 11V20ZM11 13V19H13V13H11Z"></path>
            </svg>
        </div>
    </a>
    <a href="{% url 'users:profile' %}">

        <div class="icon__account">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M20 22H4V20C4 17.2386 6.23858 15 9 15H15C17.7614 15 20 17.2386 20 20V22ZM12 13C8.68629 13 6 10.3137 6 7C6 3.68629 8.68629 1 12 1C15.3137 1 18 3.68629 18 7C18 10.3137 15.3137 13 12 13Z"></path>
            </svg>
        </div>
    </a>
    <a href="{% url 'character:character_list' %}">

        <div class="icon__chat">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M10 3H14C18.4183 3 22 6.58172 22 11C22 15.4183 18.4183 19 14 19V22.5C9 20.5 2 17.5 2 11C2 6.58172 5.58172 3 10 3Z"></path>
            </svg>
        </div>
    </a>
    <a href="{% url 'chatbot:emotion' %}">

        <div class="icon__log">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M2 13H8V21H2V13ZM9 3H15V21H9V3ZM16 8H22V21H16V8Z"></path></svg>
            
        </div>
    </a>
    <a href="로그아웃">
        <div class="icon__logout">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C15.2713 2 18.1757 3.57078 20.0002 5.99923L17.2909 5.99931C15.8807 4.75499 14.0285 4 12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C14.029 20 15.8816 19.2446 17.2919 17.9998L20.0009 17.9998C18.1765 20.4288 15.2717 22 12 22ZM19 16V13H11V11H19V8L24 12L19 16Z"></path>
            </svg>
            
        </div>
    </a>
</div>
<!-- 추가된 부분 -->
<div class="carousel">

    <div class="carousel-control-button left"><input type="radio" name="carousel-control-input"></div>
    <div class="carousel-control-button right"><input type="radio" name="carousel-control-input" checked></div>

    <div class="carousel-rotation-direction">

        <ul class="carousel-item-wrapper" style="--_num-elements: 5">

            {% for trash in character_trash %}
                <li class="carousel-item"
                    data-id="{{ trash.id }}"
                    style="--_index: {{ forloop.counter }}; --_image-url: url('{{ trash.adminCharacter.image.url }}')">
                    <a href="#" target="_blank">{{ trash.name }}</a>
                </li>
            {% endfor %}

            <li class="carousel-ground"></li>

        </ul>

    </div>

</div>
<script>
document.querySelectorAll('.logout-btn').forEach(button => {
    button.addEventListener('click', function(event) {
        event.preventDefault();  // 기본 동작 막기
        
        const csrfToken = "{{ csrf_token }}";  // CSRF 토큰 가져오기 (Django 템플릿에서)
        const logoutUrl = "{% url 'users:logout' %}";  // 로그아웃 URL 가져오기

        fetch(logoutUrl, {
            method: 'POST',  // POST 방식으로 요청
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': csrfToken  // CSRF 토큰을 헤더에 포함
            },
            body: JSON.stringify({})  // 필요한 경우 데이터를 여기에 추가
        })
        .then(response => {
            if (response.ok) {
                window.location.href = "/";  // 로그아웃 성공 시 리디렉션할 페이지 설정
            } else {
                console.error('로그아웃 실패');
            }
        })
        .catch(error => console.error('에러 발생:', error));
    });
});
</script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const items = document.querySelectorAll('.carousel-item');

        items.forEach(item => {
            item.addEventListener('click', function (event) {
                event.preventDefault();
                const itemName = item.querySelector('a').textContent;
                const itemId = item.getAttribute('data-id');
                const restoreUrl = `/trash/restore/${itemId}`;
                const deleteUrl = `/trash/perfect/delete/${itemId}`;

                // 복구 여부 확인
                if (confirm(`"${itemName}" 항목을 복구하시겠습니까?`)) {
                    // 복구를 선택했을 경우 POST 요청 전송
                    fetch(restoreUrl, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': getCsrfToken() // CSRF 토큰을 포함시켜야 함
                        },
                        body: JSON.stringify({}) // POST 요청의 본문 (필요시 데이터 추가)
                    }).then(response => {
                        if (response.ok) {
                            window.location.href = restoreUrl; // 요청 후 리디렉션
                        } else {
                            alert('복구 요청 처리 중 오류가 발생했습니다.');
                        }
                    });
                } else {
                    // 복구를 선택하지 않았을 경우 삭제 여부 확인
                    if (confirm(`"${itemName}" 항목을 삭제하시겠습니까?`)) {
                        // 삭제를 선택했을 경우 POST 요청 전송
                        fetch(deleteUrl, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'X-CSRFToken': getCsrfToken() // CSRF 토큰을 포함시켜야 함
                            },
                            body: JSON.stringify({}) // POST 요청의 본문 (필요시 데이터 추가)
                        }).then(response => {
                            if (response.ok) {
                                window.location.href = deleteUrl; // 요청 후 리디렉션
                            } else {
                                alert('삭제 요청 처리 중 오류가 발생했습니다.');
                            }
                        });
                    }
                }
            });
        });

        function getCsrfToken() {
            // 페이지에서 CSRF 토큰을 찾는 함수
            const csrfToken = document.querySelector('meta[name="csrf-token"]').getAttribute('content');
            return csrfToken;
        }
    });
</script>
</body>

</html>